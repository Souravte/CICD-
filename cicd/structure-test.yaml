schemaVersion: 2.0.0

metadataTest:
  # Image has expected default metadata
  env:
    - key: GOPATH
      value: /go
  exposedPorts: []
  volumes: []
  entrypoint: []

fileExistenceTests:
  - name: 'Docker Entry Point Exists'
    path: '/docker-entrypoint.sh'
    shouldExist: true

  - name: 'index.html'
    path: '/usr/share/nginx/html/index.html'
    shouldExist: true

  - name: 'Source Files should not exist'
    path: '/app/blog/'
    shouldExist: false

  - name: 'Hexo Link should not exist'
    path: '/usr/local/bin/hexo'
    shouldExist: false

  - name: 'Hexo should not exist'
    path: '/usr/local/lib/node_modules/hexo-cli/bin/Hexo'
    shouldExist: false

commandTests:
  # Main binary can print its version
  - name: go version
    command: go
    args: ["version"]
    expectedOutput: ["go version go1.14.6"]
    exitCode: 0
  # Can compile a valid "hello world"
  - name: hello world
    setup: [["wget", "https://raw.githubusercontent.com/go-training/helloworld/master/main.go"]]
    command: go
    args: ["run", "main.go"]
    expectedOutput: ["Hello World!!"]
    exitCode: 0
    teardown: [["rm", "main.go"]]